<%

function SQL_CONSULTA_OA(stepID)
	SQL_CONSULTA_OA = "Select * from T_FTA_METHOD_OPTION_ANALYSIS where stepID="+stepID
end function

function SQL_ATUALIZA_OA(stepID, benefit)
	SQL_ATUALIZA_OA = "UPDATE T_FTA_METHOD_OPTION_ANALYSIS SET benefit='"+benefit+"' WHERE stepID="+stepID
end function

function SQL_CRIA_OA(stepID, benefit)
	SQL_CRIA_OA = "INSERT INTO T_FTA_METHOD_OPTION_ANALYSIS (stepID, benefit) VALUES ('"+stepID+"','"+benefit+"')" 
end function





function SQL_CONSULTA_EFFECT(OAID)
	SQL_CONSULTA_EFFECT = "Select * from T_FTA_METHOD_OPTION_ANALYSIS_EFFECT where OAID="+OAID
end function

function SQL_CONSULTA_EFFECT_BY_EFFECTID(effectID)
	SQL_CONSULTA_EFFECT_BY_EFFECTID = "Select * from T_FTA_METHOD_OPTION_ANALYSIS_EFFECT where effectID="+effectID
end function

function SQL_ATUALIZA_EFFECT(effectID, effect)
	SQL_ATUALIZA_EFFECT = "UPDATE T_FTA_METHOD_OPTION_ANALYSIS_EFFECT SET DesiredEffect='"+effect+"' WHERE effectID="+effectID
end function

function SQL_DELETE_EFFECT(effectID)
	SQL_DELETE_EFFECT = "DELETE FROM T_FTA_METHOD_OPTION_ANALYSIS_EFFECT WHERE effectID="+effectID
end function

function SQL_DELETE_UNUSED_EFFECT(oaID)
	SQL_DELETE_UNUSED_EFFECT = "DELETE FROM T_FTA_METHOD_OPTION_ANALYSIS_EFFECT WHERE oaID="+oaID+" AND effectID NOT IN (SELECT DISTINCT effectID FROM T_FTA_METHOD_OPTION_ANALYSIS_CRITERIA)"
end function







function SQL_CONSULTA_CRITERIA(effectID)
	SQL_CONSULTA_CRITERIA = "Select * from T_FTA_METHOD_OPTION_ANALYSIS_CRITERIA where effectID="+effectID
end function

function SQL_CONSULTA_CRITERIA_BY_OAID(OAID)
	SQL_CONSULTA_CRITERIA_BY_OAID = "Select * from T_FTA_METHOD_OPTION_ANALYSIS_CRITERIA JOIN T_FTA_METHOD_OPTION_ANALYSIS_EFFECT ON T_FTA_METHOD_OPTION_ANALYSIS_EFFECT.effectID=T_FTA_METHOD_OPTION_ANALYSIS_CRITERIA.effectID  where T_FTA_METHOD_OPTION_ANALYSIS_EFFECT.OAID="+OAID +" ORDER BY T_FTA_METHOD_OPTION_ANALYSIS_EFFECT.effectID"
end function

function SQL_CONSULTA_CRITERIA_BY_CRITERIAID(criteriaID)
	SQL_CONSULTA_CRITERIA_BY_CRITERIAID = "Select * from T_FTA_METHOD_OPTION_ANALYSIS_CRITERIA where criteriaID="+criteriaID
end function

function SQL_ATUALIZA_CRITERIA(criteriaID, effectID, nature, statusquo)
	SQL_ATUALIZA_CRITERIA = "UPDATE T_FTA_METHOD_OPTION_ANALYSIS_CRITERIA SET effectID="+effectID+", natureofeffect='"+nature+"',  statusquo='"+statusquo+"' WHERE criteriaID="+criteriaID
end function

function SQL_DELETE_CRITERIA(criteriaID)
	SQL_DELETE_CRITERIA = "DELETE FROM T_FTA_METHOD_OPTION_ANALYSIS_CRITERIA WHERE criteriaID="+criteriaID
end function









function SQL_CONSULTA_OPTION(OAID)
	SQL_CONSULTA_OPTION = "Select * from T_FTA_METHOD_OPTION_ANALYSIS_OPTION where OAID="+OAID
end function

function SQL_CONSULTA_OPTION_BY_OPTIONID(optionID)
	SQL_CONSULTA_OPTION_BY_OPTIONID = "Select * from T_FTA_METHOD_OPTION_ANALYSIS_OPTION where optionID="+optionID
end function

function SQL_ATUALIZA_OPTION(optionID, Name, Description)
	SQL_ATUALIZA_OPTION = "UPDATE T_FTA_METHOD_OPTION_ANALYSIS_OPTION SET Name='"+name+"', Description='"+Description+"' WHERE optionID="+optionID
end function


function SQL_DELETE_OPTION(optionID)
	SQL_DELETE_OPTION = "DELETE FROM T_FTA_METHOD_OPTION_ANALYSIS_OPTION WHERE optionID="+optionID
end function








function SQL_CONSULTA_IMPACT(OAID)
	SQL_CONSULTA_IMPACT = "Select * from T_FTA_METHOD_OPTION_ANALYSIS_OPTION JOIN T_FTA_METHOD_OPTION_ANALYSIS_OPTION_X_CRITERIA ON T_FTA_METHOD_OPTION_ANALYSIS_OPTION.optionID = T_FTA_METHOD_OPTION_ANALYSIS_OPTION_X_CRITERIA.optionID  JOIN T_FTA_METHOD_OPTION_ANALYSIS_CRITERIA ON T_FTA_METHOD_OPTION_ANALYSIS_CRITERIA.criteriaID = T_FTA_METHOD_OPTION_ANALYSIS_OPTION_X_CRITERIA.criteriaID JOIN T_FTA_METHOD_OPTION_ANALYSIS_EFFECT ON T_FTA_METHOD_OPTION_ANALYSIS_CRITERIA.effectID = T_FTA_METHOD_OPTION_ANALYSIS_EFFECT.effectID where T_FTA_METHOD_OPTION_ANALYSIS_OPTION.OAID="+OAID
end function

function SQL_CONSULTA_IMPACT_BY_OPTIONID(optionID)
	SQL_CONSULTA_IMPACT_BY_OPTIONID = "Select * from T_FTA_METHOD_OPTION_ANALYSIS_OPTION_X_CRITERIA where optionID="+optionID
end function

function SQL_CONSULTA_IMPACT_BY_CRITERIAID(criteriaID)
	SQL_CONSULTA_IMPACT_BY_CRITERIAID = "Select * from T_FTA_METHOD_OPTION_ANALYSIS_OPTION_X_CRITERIA where criteriaID="+criteriaID
end function

function SQL_CONSULTA_IMPACT_BY_OPTIONID_CRITERIAID(optionID, criteriaID)
	SQL_CONSULTA_IMPACT_BY_OPTIONID_CRITERIAID = "Select * from T_FTA_METHOD_OPTION_ANALYSIS_OPTION_X_CRITERIA WHERE optionID="+optionID+" and criteriaID="+criteriaID
end function


function SQL_ATUALIZA_IMPACT(optionID,criteriaID, effect, impact)
	SQL_ATUALIZA_IMPACT = "UPDATE T_FTA_METHOD_OPTION_ANALYSIS_OPTION_X_CRITERIA SET effect='"+effect+"', impact='"+impact+"' WHERE optionID="+optionID+" and criteriaID="+criteriaID
end function


function SQL_DELETE_IMPACT(deletekey)
	SQL_DELETE_IMPACT = "DELETE FROM T_FTA_METHOD_OPTION_ANALYSIS_OPTION_X_CRITERIA WHERE deletekey="+deletekey
end function


function SQL_CRIA_IMPACT(optionID,criteriaID, effect, impact)
	SQL_CRIA_IMPACT = "INSERT INTO T_FTA_METHOD_OPTION_ANALYSIS_OPTION_X_CRITERIA (optionID,criteriaID, effect, impact) VALUES ("+optionID+","+criteriaID+",'"+effect+"','"+impact+"')" 
end function



%>